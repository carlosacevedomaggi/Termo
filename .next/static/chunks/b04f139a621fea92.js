(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,r)=>{t.exports=e.r(76562)},98150,e=>{"use strict";e.s(["default",()=>i]);var t=e.i(43476),r=e.i(22016),a=e.i(17255),s=e.i(18566),l=e.i(71645);function i(e){let{children:i}=e,{status:n}=(0,a.useSession)(),d=(0,s.useRouter)();return((0,l.useEffect)(()=>{"unauthenticated"===n&&d.push("/admin/login")},[n,d]),"loading"===n)?(0,t.jsx)("div",{className:"container-edge py-20",children:"Verificando sesión…"}):"unauthenticated"===n?null:(0,t.jsxs)("div",{className:"min-h-screen bg-slate-50",children:[(0,t.jsx)("header",{className:"border-b border-slate-200 bg-white",children:(0,t.jsxs)("div",{className:"container-edge h-16 flex items-center justify-between",children:[(0,t.jsx)("div",{children:(0,t.jsx)(r.default,{href:"/admin",className:"text-lg font-semibold",children:"Panel administrativo"})}),(0,t.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,t.jsx)(r.default,{href:"/admin/orders",className:"hover:text-blue-600",children:"Órdenes"}),(0,t.jsx)(r.default,{href:"/admin/products",className:"hover:text-blue-600",children:"Catálogo"}),(0,t.jsx)(r.default,{href:"/admin/contact",className:"hover:text-blue-600",children:"Contactos"}),(0,t.jsx)("button",{onClick:()=>(0,a.signOut)({callbackUrl:"/admin/login"}),className:"rounded-md border border-slate-200 px-3 py-1.5 hover:bg-slate-100",children:"Cerrar sesión"})]})]})}),(0,t.jsx)("main",{className:"container-edge py-10",children:i})]})}},12182,e=>{"use strict";e.s(["default",()=>o],12182);var t=e.i(43476),r=e.i(71645);(()=>{let e=Error("Cannot find module 'swr'");throw e.code="MODULE_NOT_FOUND",e})();var a=e.i(74080);(()=>{let e=Error("Cannot find module 'swr'");throw e.code="MODULE_NOT_FOUND",e})();let s=e=>fetch(e).then(e=>{if(!e.ok)throw Error("Request failed");return e.json()});function l(e){let{open:l,product:d,onClose:o,onSaved:c}=e,[u,m]=(0,r.useState)(!1),h=(0,r.useRef)(null),[x,p]=(0,r.useState)({name:"",slug:"",description:"",manufacturer:"",model:"",availability:"0",price:"0",refurbishedPrice:"",supportsCondition:!1,kitAddOnName:"",kitAddOnPrice:"",categoryId:"",heroImage:"",shortDescription:""}),[b,g]=(0,r.useState)(!1),[f,v]=(0,r.useState)(null),{data:j}=useSWR(l?"/api/admin/categories":null,s);(0,r.useEffect)(()=>{m(!0)},[]),(0,r.useEffect)(()=>{if(d){var e,t,r,a,s,l,i,n,o,c,u,m,h,x,b;p({name:null!=(t=d.name)?t:"",slug:null!=(r=d.slug)?r:"",description:null!=(a=d.description)?a:"",manufacturer:null!=(s=d.manufacturer)?s:"",model:null!=(l=d.model)?l:"",availability:String(null!=(i=d.availability)?i:0),price:((null!=(n=d.price)?n:0)/100).toString(),refurbishedPrice:d.refurbishedPrice?((null!=(o=d.refurbishedPrice)?o:0)/100).toString():"",supportsCondition:!!d.supportsCondition,kitAddOnName:null!=(c=d.kitAddOnName)?c:"",kitAddOnPrice:d.kitAddOnPrice?((null!=(u=d.kitAddOnPrice)?u:0)/100).toString():"",categoryId:null!=(h=null!=(m=d.categoryId)?m:null==(e=d.category)?void 0:e.id)?h:"",heroImage:null!=(x=d.heroImage)?x:"",shortDescription:null!=(b=d.shortDescription)?b:""})}else p(e=>({...e,name:"",slug:"",description:"",manufacturer:"",model:"",availability:"0",price:"0",refurbishedPrice:"",supportsCondition:!1,kitAddOnName:"",kitAddOnPrice:"",categoryId:"",heroImage:"",shortDescription:""}))},[d]),(0,r.useEffect)(()=>{if(!l)return;let e=e=>{"Escape"===e.key&&o()},t=e=>{h.current&&!h.current.contains(e.target)&&o()};return document.addEventListener("keydown",e),document.addEventListener("mousedown",t),()=>{document.removeEventListener("keydown",e),document.removeEventListener("mousedown",t)}},[l,o]);let N=(0,r.useMemo)(()=>{var e;return null!=(e=null==j?void 0:j.categories)?e:[]},[j]);return u&&l?(0,a.createPortal)((0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:(0,t.jsxs)("div",{ref:h,className:"w-full max-w-2xl rounded-3xl bg-white p-6 shadow-xl focus:outline-none",tabIndex:-1,children:[(0,t.jsxs)("header",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:d?"Editar producto":"Nuevo producto"}),(0,t.jsx)("p",{className:"text-sm text-slate-600",children:"Completa la información para el catálogo."})]}),(0,t.jsx)("button",{onClick:()=>{b||o()},className:"rounded-full border border-slate-200 px-3 py-1 text-sm text-slate-600 hover:bg-slate-100",children:"Cerrar"})]}),(0,t.jsxs)("form",{className:"mt-5 space-y-4",onSubmit:async e=>{e.preventDefault(),g(!0),v(null);try{let e={name:x.name,slug:x.slug,description:x.description,manufacturer:x.manufacturer||void 0,model:x.model||void 0,availability:Number(x.availability)||0,price:Math.round(100*(Number(x.price)||0)),refurbishedPrice:x.refurbishedPrice?Math.round(100*(Number(x.refurbishedPrice)||0)):void 0,supportsCondition:x.supportsCondition,kitAddOnName:x.kitAddOnName||void 0,kitAddOnPrice:x.kitAddOnPrice?Math.round(100*(Number(x.kitAddOnPrice)||0)):void 0,categoryId:x.categoryId,heroImage:x.heroImage||void 0,shortDescription:x.shortDescription||void 0},t=d?"/api/admin/products/".concat(d.id):"/api/admin/products",r=d?"PATCH":"POST";if(!(await fetch(t,{method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw Error("Error al guardar el producto");c(),o()}catch(e){console.error(e),v(e.message||"No se pudo guardar el producto")}finally{g(!1)}},children:[(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,t.jsx)(i,{label:"Nombre",value:x.name,onChange:e=>p(t=>({...t,name:e})),required:!0}),(0,t.jsx)(i,{label:"Slug",value:x.slug,onChange:e=>p(t=>({...t,slug:e})),required:!0}),(0,t.jsx)(n,{label:"Categoría",value:x.categoryId,onChange:e=>p(t=>({...t,categoryId:e})),options:N.map(e=>({value:e.id,label:e.name})),placeholder:"Selecciona una categoría",required:!0}),(0,t.jsx)(i,{label:"Inventario",type:"number",value:x.availability,onChange:e=>p(t=>({...t,availability:e}))}),(0,t.jsx)(i,{label:"Precio (USD)",type:"number",value:x.price,onChange:e=>p(t=>({...t,price:e})),required:!0}),(0,t.jsx)(i,{label:"Precio reacondicionado (USD)",type:"number",value:x.refurbishedPrice,onChange:e=>p(t=>({...t,refurbishedPrice:e}))})]}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,t.jsx)(i,{label:"Fabricante",value:x.manufacturer,onChange:e=>p(t=>({...t,manufacturer:e}))}),(0,t.jsx)(i,{label:"Modelo",value:x.model,onChange:e=>p(t=>({...t,model:e}))}),(0,t.jsx)(i,{label:"Kit (nombre)",value:x.kitAddOnName,onChange:e=>p(t=>({...t,kitAddOnName:e}))}),(0,t.jsx)(i,{label:"Kit (precio USD)",value:x.kitAddOnPrice,onChange:e=>p(t=>({...t,kitAddOnPrice:e}))})]}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,t.jsx)(i,{label:"Imagen destacada (URL)",value:x.heroImage,onChange:e=>p(t=>({...t,heroImage:e}))}),(0,t.jsx)(i,{label:"Descripción corta",value:x.shortDescription,onChange:e=>p(t=>({...t,shortDescription:e}))})]}),(0,t.jsx)("div",{children:(0,t.jsxs)("label",{className:"flex items-center gap-2 text-sm text-slate-700",children:[(0,t.jsx)("input",{type:"checkbox",checked:x.supportsCondition,onChange:e=>p(t=>({...t,supportsCondition:e.target.checked}))}),"Mostrar opción de reacondicionado"]})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Descripción"}),(0,t.jsx)("textarea",{className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200",rows:4,value:x.description,onChange:e=>p(t=>({...t,description:e.target.value}))})]}),f&&(0,t.jsx)("p",{className:"text-sm text-red-600",children:f}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,t.jsx)("button",{type:"button",className:"btn btn-outline",onClick:o,disabled:b,children:"Cancelar"}),(0,t.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:b,children:b?"Guardando…":"Guardar"})]})]})]})}),document.body):null}function i(e){let{label:r,value:a,onChange:s,type:l="text",required:i}=e;return(0,t.jsxs)("label",{className:"block text-sm font-medium text-slate-700",children:[r,(0,t.jsx)("input",{type:l,value:a,required:i,onChange:e=>s(e.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200"})]})}function n(e){let{label:r,value:a,onChange:s,options:l,placeholder:i,required:n}=e;return(0,t.jsxs)("label",{className:"block text-sm font-medium text-slate-700",children:[r,(0,t.jsxs)("select",{value:a,onChange:e=>s(e.target.value),required:n,className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200",children:[(0,t.jsx)("option",{value:"",children:null!=i?i:"Selecciona"}),l.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))]})]})}let d=e=>fetch(e).then(e=>{if(!e.ok)throw Error("Request failed");return e.json()});function o(){var e;let{data:a,error:s,isLoading:i,mutate:n}=useSWR("/api/admin/products",d),[o,c]=(0,r.useState)(null),[u,m]=(0,r.useState)(!1);return i?(0,t.jsx)("div",{children:"Cargando productos…"}):s?(0,t.jsx)("div",{className:"text-red-600",children:"No se pudieron cargar los productos."}):(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200",children:[(0,t.jsxs)("header",{className:"flex items-center justify-between border-b border-slate-200 px-6 py-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl font-semibold",children:"Catálogo"}),(0,t.jsx)("p",{className:"text-sm text-slate-500",children:"Administre los productos visibles en la tienda."})]}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)("button",{onClick:()=>{c(null),m(!0)},className:"rounded-md bg-blue-600 px-3 py-2 text-sm font-medium text-white",children:"Nuevo producto"})})]}),(0,t.jsx)("div",{className:"px-6 py-4",children:(0,t.jsxs)("table",{className:"min-w-full text-sm",children:[(0,t.jsx)("thead",{className:"text-left text-xs uppercase tracking-wide text-slate-500",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"py-2",children:"Nombre"}),(0,t.jsx)("th",{className:"py-2",children:"Categoría"}),(0,t.jsx)("th",{className:"py-2",children:"Precio"}),(0,t.jsx)("th",{className:"py-2",children:"Inventario"}),(0,t.jsx)("th",{className:"py-2"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-slate-200",children:null==a||null==(e=a.products)?void 0:e.map(e=>{var r,a;return(0,t.jsxs)("tr",{className:"hover:bg-slate-50",children:[(0,t.jsxs)("td",{className:"py-3",children:[(0,t.jsx)("div",{className:"font-medium text-slate-900",children:e.name}),(0,t.jsx)("div",{className:"text-xs text-slate-500",children:e.slug})]}),(0,t.jsx)("td",{className:"py-3 text-slate-700",children:null!=(a=null==(r=e.category)?void 0:r.name)?a:"Sin categoría"}),(0,t.jsxs)("td",{className:"py-3 text-slate-700",children:["$",(e.price/100).toFixed(2)]}),(0,t.jsx)("td",{className:"py-3 text-slate-700",children:e.availability}),(0,t.jsx)("td",{className:"py-3",children:(0,t.jsx)("div",{className:"flex justify-end gap-2",children:(0,t.jsx)("button",{onClick:()=>{c(e),m(!0)},className:"rounded-md border border-slate-200 px-3 py-1.5 text-xs font-medium hover:bg-slate-100",children:"Editar"})})})]},e.id)})})]})}),(0,t.jsx)(l,{open:u,product:o,onClose:()=>{m(!1),c(null)},onSaved:()=>n()})]})}}]);