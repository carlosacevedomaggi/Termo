{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/chickynice/Desktop/ec2/termo/src/app/checkout/components/Map.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useEffect, useMemo, useState } from \"react\"\r\nimport { MapContainer, TileLayer, Marker, Popup, useMapEvents } from \"react-leaflet\"\r\nimport L from \"leaflet\"\r\n\r\nimport type { PartnerLocation } from \"@/lib/partners\"\r\n\r\nconst defaultIcon = new L.Icon({\r\n  iconUrl: \"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png\",\r\n  iconRetinaUrl: \"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png\",\r\n  iconSize: [25, 41],\r\n  iconAnchor: [12, 41],\r\n  popupAnchor: [1, -34],\r\n  shadowUrl: \"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png\",\r\n})\r\n\r\nconst highlightedIcon = new L.Icon({\r\n  iconUrl: \"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png\",\r\n  iconSize: [30, 50],\r\n  iconAnchor: [15, 50],\r\n  popupAnchor: [1, -40],\r\n  shadowUrl: \"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png\",\r\n})\r\n\r\nconst defaultCenter: [number, number] = [10.491016, -66.902656] // Caracas\r\nconst defaultZoom = 6\r\n\r\nexport type MapProps = {\r\n  customerLocation: { lat: number; lng: number; label: string } | null\r\n  partners: PartnerLocation[]\r\n  fulfillmentMode: \"pickup\" | \"delivery\"\r\n  selectedPartnerId: string | null\r\n  onCustomerLocationChange: (location: { lat: number; lng: number; label: string }) => void\r\n  onSelectPartner: (partnerId: string) => void\r\n}\r\n\r\nexport default function Map({\r\n  customerLocation,\r\n  partners,\r\n  fulfillmentMode,\r\n  selectedPartnerId,\r\n  onCustomerLocationChange,\r\n  onSelectPartner,\r\n}: MapProps) {\r\n  const [center, setCenter] = useState<[number, number]>(customerLocation ? [customerLocation.lat, customerLocation.lng] : defaultCenter)\r\n  const zoom = customerLocation ? 13 : defaultZoom\r\n\r\n  useEffect(() => {\r\n    if (customerLocation) {\r\n      setCenter([customerLocation.lat, customerLocation.lng])\r\n    }\r\n  }, [customerLocation])\r\n\r\n  return (\r\n    <MapContainer center={center} zoom={zoom} className=\"h-full w-full\" scrollWheelZoom={true}>\r\n      <TileLayer\r\n        url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n        attribution=\"&copy; <a href='https://www.openstreetmap.org/copyright'>OpenStreetMap</a>\"\r\n      />\r\n      <DraggableMarker\r\n        customerLocation={customerLocation}\r\n        onChange={(position) => {\r\n          onCustomerLocationChange({\r\n            lat: position.lat,\r\n            lng: position.lng,\r\n            label: customerLocation?.label ?? `${position.lat.toFixed(6)}, ${position.lng.toFixed(6)}`,\r\n          })\r\n        }}\r\n      />\r\n      {partners.map((partner) => (\r\n        <Marker\r\n          key={partner.id}\r\n          position={[partner.lat, partner.lng]}\r\n          icon={partner.id === selectedPartnerId ? highlightedIcon : defaultIcon}\r\n          eventHandlers={{\r\n            click: () => onSelectPartner(partner.id),\r\n          }}\r\n        >\r\n          <Popup>\r\n            <div className=\"space-y-1 text-sm\">\r\n              <div className=\"font-semibold\">{partner.name}</div>\r\n              <div className=\"text-xs text-slate-600\">{partner.address}</div>\r\n              <div className=\"text-[11px] uppercase tracking-wide text-slate-400\">{partner.cityState}</div>\r\n              <button\r\n                type=\"button\"\r\n                className=\"mt-2 w-full rounded-md bg-blue-600 px-2 py-1 text-[11px] font-semibold text-white\"\r\n                onClick={() => onSelectPartner(partner.id)}\r\n              >\r\n                {fulfillmentMode === \"pickup\" ? \"Seleccionar aliado\" : \"Asignar aliado\"}\r\n              </button>\r\n            </div>\r\n          </Popup>\r\n        </Marker>\r\n      ))}\r\n    </MapContainer>\r\n  )\r\n}\r\n\r\nfunction DraggableMarker({\r\n  customerLocation,\r\n  onChange,\r\n}: {\r\n  customerLocation: { lat: number; lng: number; label: string } | null\r\n  onChange: (position: { lat: number; lng: number }) => void\r\n}) {\r\n  const [position, setPosition] = useState<[number, number]>(customerLocation ? [customerLocation.lat, customerLocation.lng] : defaultCenter)\r\n\r\n  const map = useMapEvents({\r\n    click(event) {\r\n      const { lat, lng } = event.latlng\r\n      setPosition([lat, lng])\r\n      onChange({ lat, lng })\r\n    },\r\n  })\r\n\r\n  useEffect(() => {\r\n    if (customerLocation) {\r\n      setPosition([customerLocation.lat, customerLocation.lng])\r\n      map.setView([customerLocation.lat, customerLocation.lng], 14)\r\n    }\r\n  }, [customerLocation, map])\r\n\r\n  return <Marker position={position} draggable eventHandlers={{ dragend: (event) => {\r\n    const marker = event.target as L.Marker\r\n    const { lat, lng } = marker.getLatLng()\r\n    setPosition([lat, lng])\r\n    onChange({ lat, lng })\r\n  } }} icon={highlightedIcon} />\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}