module.exports=[50944,(a,b,c)=>{b.exports=a.r(74137)},49385,a=>{"use strict";a.s(["default",()=>g]);var b=a.i(87924),c=a.i(38246),d=a.i(75003),e=a.i(50944),f=a.i(72131);function g({children:a}){let{status:g}=(0,d.useSession)(),h=(0,e.useRouter)();return((0,f.useEffect)(()=>{"unauthenticated"===g&&h.push("/admin/login")},[g,h]),"loading"===g)?(0,b.jsx)("div",{className:"container-edge py-20",children:"Verificando sesión…"}):"unauthenticated"===g?null:(0,b.jsxs)("div",{className:"min-h-screen bg-slate-50",children:[(0,b.jsx)("header",{className:"border-b border-slate-200 bg-white",children:(0,b.jsxs)("div",{className:"container-edge h-16 flex items-center justify-between",children:[(0,b.jsx)("div",{children:(0,b.jsx)(c.default,{href:"/admin",className:"text-lg font-semibold",children:"Panel administrativo"})}),(0,b.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,b.jsx)(c.default,{href:"/admin/orders",className:"hover:text-blue-600",children:"Órdenes"}),(0,b.jsx)(c.default,{href:"/admin/products",className:"hover:text-blue-600",children:"Catálogo"}),(0,b.jsx)(c.default,{href:"/admin/contact",className:"hover:text-blue-600",children:"Contactos"}),(0,b.jsx)("button",{onClick:()=>(0,d.signOut)({callbackUrl:"/admin/login"}),className:"rounded-md border border-slate-200 px-3 py-1.5 hover:bg-slate-100",children:"Cerrar sesión"})]})]})}),(0,b.jsx)("main",{className:"container-edge py-10",children:a})]})}},28350,a=>{"use strict";a.s(["default",()=>j],28350);var b=a.i(87924),c=a.i(72131);(()=>{let a=Error("Cannot find module 'swr'");throw a.code="MODULE_NOT_FOUND",a})();var d=a.i(35112);(()=>{let a=Error("Cannot find module 'swr'");throw a.code="MODULE_NOT_FOUND",a})();let e=a=>fetch(a).then(a=>{if(!a.ok)throw Error("Request failed");return a.json()});function f({open:a,product:f,onClose:i,onSaved:j}){let[k,l]=(0,c.useState)(!1),m=(0,c.useRef)(null),[n,o]=(0,c.useState)({name:"",slug:"",description:"",manufacturer:"",model:"",availability:"0",price:"0",refurbishedPrice:"",supportsCondition:!1,kitAddOnName:"",kitAddOnPrice:"",categoryId:"",heroImage:"",shortDescription:""}),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(null),{data:t}=useSWR(a?"/api/admin/categories":null,e);(0,c.useEffect)(()=>{l(!0)},[]),(0,c.useEffect)(()=>{f?o({name:f.name??"",slug:f.slug??"",description:f.description??"",manufacturer:f.manufacturer??"",model:f.model??"",availability:String(f.availability??0),price:((f.price??0)/100).toString(),refurbishedPrice:f.refurbishedPrice?((f.refurbishedPrice??0)/100).toString():"",supportsCondition:!!f.supportsCondition,kitAddOnName:f.kitAddOnName??"",kitAddOnPrice:f.kitAddOnPrice?((f.kitAddOnPrice??0)/100).toString():"",categoryId:f.categoryId??f.category?.id??"",heroImage:f.heroImage??"",shortDescription:f.shortDescription??""}):o(a=>({...a,name:"",slug:"",description:"",manufacturer:"",model:"",availability:"0",price:"0",refurbishedPrice:"",supportsCondition:!1,kitAddOnName:"",kitAddOnPrice:"",categoryId:"",heroImage:"",shortDescription:""}))},[f]),(0,c.useEffect)(()=>{if(!a)return;let b=a=>{"Escape"===a.key&&i()},c=a=>{m.current&&!m.current.contains(a.target)&&i()};return document.addEventListener("keydown",b),document.addEventListener("mousedown",c),()=>{document.removeEventListener("keydown",b),document.removeEventListener("mousedown",c)}},[a,i]);let u=(0,c.useMemo)(()=>t?.categories??[],[t]);return k&&a?(0,d.createPortal)((0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:(0,b.jsxs)("div",{ref:m,className:"w-full max-w-2xl rounded-3xl bg-white p-6 shadow-xl focus:outline-none",tabIndex:-1,children:[(0,b.jsxs)("header",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:f?"Editar producto":"Nuevo producto"}),(0,b.jsx)("p",{className:"text-sm text-slate-600",children:"Completa la información para el catálogo."})]}),(0,b.jsx)("button",{onClick:()=>{p||i()},className:"rounded-full border border-slate-200 px-3 py-1 text-sm text-slate-600 hover:bg-slate-100",children:"Cerrar"})]}),(0,b.jsxs)("form",{className:"mt-5 space-y-4",onSubmit:async a=>{a.preventDefault(),q(!0),s(null);try{let a={name:n.name,slug:n.slug,description:n.description,manufacturer:n.manufacturer||void 0,model:n.model||void 0,availability:Number(n.availability)||0,price:Math.round(100*(Number(n.price)||0)),refurbishedPrice:n.refurbishedPrice?Math.round(100*(Number(n.refurbishedPrice)||0)):void 0,supportsCondition:n.supportsCondition,kitAddOnName:n.kitAddOnName||void 0,kitAddOnPrice:n.kitAddOnPrice?Math.round(100*(Number(n.kitAddOnPrice)||0)):void 0,categoryId:n.categoryId,heroImage:n.heroImage||void 0,shortDescription:n.shortDescription||void 0},b=f?`/api/admin/products/${f.id}`:"/api/admin/products",c=f?"PATCH":"POST";if(!(await fetch(b,{method:c,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok)throw Error("Error al guardar el producto");j(),i()}catch(a){console.error(a),s(a.message||"No se pudo guardar el producto")}finally{q(!1)}},children:[(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsx)(g,{label:"Nombre",value:n.name,onChange:a=>o(b=>({...b,name:a})),required:!0}),(0,b.jsx)(g,{label:"Slug",value:n.slug,onChange:a=>o(b=>({...b,slug:a})),required:!0}),(0,b.jsx)(h,{label:"Categoría",value:n.categoryId,onChange:a=>o(b=>({...b,categoryId:a})),options:u.map(a=>({value:a.id,label:a.name})),placeholder:"Selecciona una categoría",required:!0}),(0,b.jsx)(g,{label:"Inventario",type:"number",value:n.availability,onChange:a=>o(b=>({...b,availability:a}))}),(0,b.jsx)(g,{label:"Precio (USD)",type:"number",value:n.price,onChange:a=>o(b=>({...b,price:a})),required:!0}),(0,b.jsx)(g,{label:"Precio reacondicionado (USD)",type:"number",value:n.refurbishedPrice,onChange:a=>o(b=>({...b,refurbishedPrice:a}))})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsx)(g,{label:"Fabricante",value:n.manufacturer,onChange:a=>o(b=>({...b,manufacturer:a}))}),(0,b.jsx)(g,{label:"Modelo",value:n.model,onChange:a=>o(b=>({...b,model:a}))}),(0,b.jsx)(g,{label:"Kit (nombre)",value:n.kitAddOnName,onChange:a=>o(b=>({...b,kitAddOnName:a}))}),(0,b.jsx)(g,{label:"Kit (precio USD)",value:n.kitAddOnPrice,onChange:a=>o(b=>({...b,kitAddOnPrice:a}))})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsx)(g,{label:"Imagen destacada (URL)",value:n.heroImage,onChange:a=>o(b=>({...b,heroImage:a}))}),(0,b.jsx)(g,{label:"Descripción corta",value:n.shortDescription,onChange:a=>o(b=>({...b,shortDescription:a}))})]}),(0,b.jsx)("div",{children:(0,b.jsxs)("label",{className:"flex items-center gap-2 text-sm text-slate-700",children:[(0,b.jsx)("input",{type:"checkbox",checked:n.supportsCondition,onChange:a=>o(b=>({...b,supportsCondition:a.target.checked}))}),"Mostrar opción de reacondicionado"]})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Descripción"}),(0,b.jsx)("textarea",{className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200",rows:4,value:n.description,onChange:a=>o(b=>({...b,description:a.target.value}))})]}),r&&(0,b.jsx)("p",{className:"text-sm text-red-600",children:r}),(0,b.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,b.jsx)("button",{type:"button",className:"btn btn-outline",onClick:i,disabled:p,children:"Cancelar"}),(0,b.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:p,children:p?"Guardando…":"Guardar"})]})]})]})}),document.body):null}function g({label:a,value:c,onChange:d,type:e="text",required:f}){return(0,b.jsxs)("label",{className:"block text-sm font-medium text-slate-700",children:[a,(0,b.jsx)("input",{type:e,value:c,required:f,onChange:a=>d(a.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200"})]})}function h({label:a,value:c,onChange:d,options:e,placeholder:f,required:g}){return(0,b.jsxs)("label",{className:"block text-sm font-medium text-slate-700",children:[a,(0,b.jsxs)("select",{value:c,onChange:a=>d(a.target.value),required:g,className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200",children:[(0,b.jsx)("option",{value:"",children:f??"Selecciona"}),e.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))]})]})}let i=a=>fetch(a).then(a=>{if(!a.ok)throw Error("Request failed");return a.json()});function j(){let{data:a,error:d,isLoading:e,mutate:g}=useSWR("/api/admin/products",i),[h,j]=(0,c.useState)(null),[k,l]=(0,c.useState)(!1);return e?(0,b.jsx)("div",{children:"Cargando productos…"}):d?(0,b.jsx)("div",{className:"text-red-600",children:"No se pudieron cargar los productos."}):(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200",children:[(0,b.jsxs)("header",{className:"flex items-center justify-between border-b border-slate-200 px-6 py-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-xl font-semibold",children:"Catálogo"}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"Administre los productos visibles en la tienda."})]}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsx)("button",{onClick:()=>{j(null),l(!0)},className:"rounded-md bg-blue-600 px-3 py-2 text-sm font-medium text-white",children:"Nuevo producto"})})]}),(0,b.jsx)("div",{className:"px-6 py-4",children:(0,b.jsxs)("table",{className:"min-w-full text-sm",children:[(0,b.jsx)("thead",{className:"text-left text-xs uppercase tracking-wide text-slate-500",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"py-2",children:"Nombre"}),(0,b.jsx)("th",{className:"py-2",children:"Categoría"}),(0,b.jsx)("th",{className:"py-2",children:"Precio"}),(0,b.jsx)("th",{className:"py-2",children:"Inventario"}),(0,b.jsx)("th",{className:"py-2"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-slate-200",children:a?.products?.map(a=>(0,b.jsxs)("tr",{className:"hover:bg-slate-50",children:[(0,b.jsxs)("td",{className:"py-3",children:[(0,b.jsx)("div",{className:"font-medium text-slate-900",children:a.name}),(0,b.jsx)("div",{className:"text-xs text-slate-500",children:a.slug})]}),(0,b.jsx)("td",{className:"py-3 text-slate-700",children:a.category?.name??"Sin categoría"}),(0,b.jsxs)("td",{className:"py-3 text-slate-700",children:["$",(a.price/100).toFixed(2)]}),(0,b.jsx)("td",{className:"py-3 text-slate-700",children:a.availability}),(0,b.jsx)("td",{className:"py-3",children:(0,b.jsx)("div",{className:"flex justify-end gap-2",children:(0,b.jsx)("button",{onClick:()=>{j(a),l(!0)},className:"rounded-md border border-slate-200 px-3 py-1.5 text-xs font-medium hover:bg-slate-100",children:"Editar"})})})]},a.id))})]})}),(0,b.jsx)(f,{open:k,product:h,onClose:()=>{l(!1),j(null)},onSaved:()=>g()})]})}}];

//# sourceMappingURL=_3e7311af._.js.map